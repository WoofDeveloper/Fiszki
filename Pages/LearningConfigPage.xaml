<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:Fiszki.PageModels"
             x:Class="Fiszki.Pages.LearningConfigPage"
             x:DataType="vm:LearningConfigPageModel"
             Title="Konfiguracja sesji nauki"
             BackgroundColor="#F5F5F5">

    <ScrollView>
        <VerticalStackLayout Padding="20" Spacing="20">
            
            <Border StrokeShape="RoundRectangle 12" 
                    BackgroundColor="White" 
                    Stroke="#E0E0E0" 
                    StrokeThickness="1"
                    Padding="16">
                <VerticalStackLayout Spacing="12">
                    <Label Text="Wybierz kategorie" 
                           FontSize="16" 
                           FontAttributes="Bold"
                           TextColor="#212121"/>
                    <Picker ItemsSource="{Binding Categories}"
                            SelectedItem="{Binding SelectedCategory}"
                            ItemDisplayBinding="{Binding Title}"
                            BackgroundColor="#F5F5F5"
                            TextColor="#212121"/>
                </VerticalStackLayout>
            </Border>

            <Border StrokeShape="RoundRectangle 12" 
                    BackgroundColor="White" 
                    Stroke="#E0E0E0" 
                    StrokeThickness="1"
                    Padding="16">
                <VerticalStackLayout Spacing="12">
                    <Label Text="Liczba fiszek" 
                           FontSize="16" 
                           FontAttributes="Bold"
                           TextColor="#212121"/>

                    <HorizontalStackLayout Spacing="10">
                        <CheckBox IsChecked="{Binding UseAllFlashcards}" 
                                  Color="#2196F3"
                                  VerticalOptions="Center"/>
                        <Label Text="Wszystkie fiszki" 
                               FontSize="14"
                               TextColor="#424242"
                               VerticalOptions="Center"/>
                    </HorizontalStackLayout>

                    <HorizontalStackLayout Spacing="10" IsEnabled="{Binding UseAllFlashcards, Converter={StaticResource InvertedBoolConverter}}">
                        <Stepper Value="{Binding FlashcardCount}" 
                                 Minimum="1" 
                                 Maximum="50" 
                                 Increment="5"
                                 VerticalOptions="Center"
                                 IsEnabled="{Binding UseAllFlashcards, Converter={StaticResource InvertedBoolConverter}}"/>
                        <Label FontSize="18"
                               FontAttributes="Bold"
                               TextColor="#2196F3"
                               VerticalOptions="Center">
                            <Label.Text>
                                <MultiBinding StringFormat="{}{ 0}">
                                    <Binding Path="DisplayCount"/>
                                </MultiBinding>
                            </Label.Text>
                        </Label>
                    </HorizontalStackLayout>
                </VerticalStackLayout>
            </Border>

            <Border StrokeShape="RoundRectangle 12" 
                    BackgroundColor="White" 
                    Stroke="#E0E0E0" 
                    StrokeThickness="1"
                    Padding="16">
                <VerticalStackLayout Spacing="12">
                    <Label Text="Opcje nauki" 
                           FontSize="16" 
                           FontAttributes="Bold"
                           TextColor="#212121"/>
                    
                    <HorizontalStackLayout Spacing="10">
                        <CheckBox IsChecked="{Binding OnlyDueForReview}" 
                                  Color="#2196F3"
                                  VerticalOptions="Center"/>
                        <Label Text="Tylko fiszki do powtorki" 
                               FontSize="14"
                               TextColor="#424242"
                               VerticalOptions="Center"/>
                    </HorizontalStackLayout>
                    
                    <HorizontalStackLayout Spacing="10">
                        <CheckBox IsChecked="{Binding PrioritizeWrongAnswers}" 
                                  Color="#2196F3"
                                  VerticalOptions="Center"/>
                        <Label Text="Priorytet blednych odpowiedzi" 
                               FontSize="14"
                               TextColor="#424242"
                               VerticalOptions="Center"/>
                    </HorizontalStackLayout>
                </VerticalStackLayout>
            </Border>

            <Border StrokeShape="RoundRectangle 12" 
                    BackgroundColor="#E3F2FD" 
                    Stroke="#2196F3" 
                    StrokeThickness="1"
                    Padding="16">
                <VerticalStackLayout Spacing="8">
                    <Label Text="Statystyki" 
                           FontSize="16" 
                           FontAttributes="Bold"
                           TextColor="#1976D2"/>
                    <HorizontalStackLayout Spacing="5">
                        <Label Text="Dostepne fiszki:" 
                               FontSize="14"
                               TextColor="#424242"/>
                        <Label Text="{Binding TotalAvailable}" 
                               FontSize="14"
                               FontAttributes="Bold"
                               TextColor="#2196F3"/>
                    </HorizontalStackLayout>
                    <HorizontalStackLayout Spacing="5">
                        <Label Text="Do powtorki:" 
                               FontSize="14"
                               TextColor="#424242"/>
                        <Label Text="{Binding DueForReview}" 
                               FontSize="14"
                               FontAttributes="Bold"
                               TextColor="#FF5722"/>
                    </HorizontalStackLayout>
                </VerticalStackLayout>
            </Border>

            <Grid ColumnDefinitions="*,*" ColumnSpacing="10" Margin="0,10,0,0">
                <Button Grid.Column="0"
                        Text="Anuluj"
                        BackgroundColor="#757575"
                        TextColor="White"
                        CornerRadius="8"
                        HeightRequest="50"
                        Command="{Binding CancelCommand}"/>
                
                <Button Grid.Column="1"
                        Text="Rozpocznij nauke"
                        BackgroundColor="#4CAF50"
                        TextColor="White"
                        CornerRadius="8"
                        HeightRequest="50"
                        Command="{Binding StartLearningCommand}"/>
            </Grid>

        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
